













........































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































#  简介

Spring Cloud Bus配合Apring Cloud Config使用可以实现配置的动态刷新。



### 架构图

![](../\图片\springconfig的26.png)





Spring Cloud Bus 能管理和传播分布式系统间的消息，就像分布式执行器，可用于广播状态更改，事件推送等，也可以当作微服务间的通信通道。



![](../\图片\springconfig的31.png)



注意,这里两张图片,就代表两种广播方式

			图1: **它是Bus直接通知给其中一个客户端,由这个客户端开始蔓延,传播给其他所有客户端**
			图2:	它**是通知给配置中心的服务端,有服务端广播给所有客户端**




# 为什么被称为总线

#### 什么是总线

在微服务架构的系统中，通常会使用轻量级的消息代理来构建一个共用的消息主题，并让系统所有的微服务实列都连接上来，由于该主题中产生的消息会被所有的实列监听和消费，所有称它为消息总线，在总线上的各个实列，都可以方便的广播一些需要让其他连接在该主题上的实列都知道的消息。

#### 基本原理

ConfigClient 实列都监听MQ中同一个topic(默认springCloudBus).当一个服务刷新数据的时候。他会把这个消息放入Topic中，这样其他监听同一个Topic的服务就能得知通知，然后去更新自身的配置。

简单的理解，就是通过消息队列达到广播的效果，我们要广播某个消息时，把他放到某个topic 中，所有监听的节点都可以获取到。

