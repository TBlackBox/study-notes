# 简介
DDos全名Distributed Denial of Service，翻译成中文就是分布式拒绝服务。指的是处于不同位置的多个攻击者同时向一个或数个目标发动攻击，是一种分布的、协同的大规模攻击方式。单一的DoS攻击一般是采用一对一方式的，它利用网络协议和操作系统的一些缺陷，采用欺骗和伪装的策略来进行网络攻击，使网站服务器充斥大量要求回复的信息，消耗网络带宽或系统资源，导致网络或系统不胜负荷以至于瘫痪而停止提供正常的网络服务。


## 几种攻击的说明

### DoS 拒绝服务

### DDoS 分布式拒绝服务

### DRDoS 分布式反射拒绝服务

### CC   Challenge Collapsar

举例说明
有两个面馆    A面馆   B面馆，两个是竞争关系

攻击可以理解为 去面馆，但不吃面做到座位上只和店里提供的免费茶水和座位，座位都是有限的。

1. A比B大的的情况（Dos攻击）
A分出一部分资源（钱），不停的对B进行FLOOD攻击，导致B关门了，A只损失以一小部分，这就是Dos攻击

2. A比B小的情况（DDos攻击）
A 有很多兄弟面馆，甚至还有一些肉鸡。一起对B发起FLOOD攻击。B又关门了


3. B很大，A和他的朋友都打不动了
B很大，A和他的朋友打不动了。于是他们找到了很多公网提供的服务。如redis、mongodb、memcache、NTP、UPnP.....  然后一起对这些服务发送伪造的请求。如：Hi  memcache，请把缓存的数据发给我。我的IP是B。（放大了几百倍）     这种攻击叫反射攻击。于是大量的反射攻击开始了。  全球几十万的弱验证开放服务一起给B发送数据。B又关门了。这就是DRDoS。


4. CC攻击
 B很生气，于是在运营商层面部署了很多硬防来清洗流量。 DDoS DRDoS 也没办法了。这时候A突然发现B有一个数据查询接口，部署在公网。如：会员信息查询之类的。A又联合他的兄弟，甚至找了很多公开的免费代理。一起对这个接口进行请求。每秒几十万次查询。最终B的会员数据库挂了。B又关门了。这就是CC攻击。

## 下面是常见的攻击方式
 ICMP Flood、UDP Flood、NTP Flood、SYN Flood、CC 攻击、DNS Query Flood

# SYN Flood进行DDoS攻击的实现原理（网络层攻击）
 SYN Flood是一种利用TCP协议缺陷，发送大量伪造的TCP连接请求，从而使得被攻击方资源耗尽（CPU满负荷或内存不足）的攻击方式。

一次正常的建立TCP连接，需要三次握手：客户端发送SYN报文，服务端收到请求并返回报文表示接受，客户端也返回确认，完成连接。

SYN Flood 就是用户向服务器发送报文后突然死机或掉线，那么服务器在发出应答报文后就无法收到客户端的确认报文（第三次握手无法完成），这时服务器端一般会重试并等待一段时间后再丢弃这个未完成的连接。

一个用户出现异常导致服务器的一个线程等待一会儿并不是大问题，但恶意攻击者大量模拟这种情况，服务器端为了维护数以万计的半连接而消耗非常多的资源，结果往往是无暇理睬客户的正常请求，甚至崩溃。从正常客户的角度看来，网站失去了响应，无法访问。

# 应用层ddos攻击
1. 通过限流的形式，对每个客户短做一个请求频率的限制。

2. 应用代码性能优化
- 合理运用缓存解决数据库压力
- 及时释放资源，减少空连接的消耗
3. 网络架构优化
- 利用负载均衡分流，避免点点问题
- 充分利用cdn和镜像站点分流缓解主站压力

# 实现对抗手段
- 限制每个ip的请求频率
- 高级的验证码

#   如何应对 DDoS 攻击

##  高防服务器

还是拿开的A,B面馆举例，高防服务器就是我给B面馆增加了两名保安，这两名保安可以让保护店铺不受只喝免费茶，不吃面的人干扰，并定时清理店里面是否又这种人，有都清出去。把座位让给吃面的人（也就是正常用户）。
高防服务器主要是指能独立硬防御 50Gbps 以上的服务器，能够帮助网站拒绝服务攻击，定期扫描网络主节点等，这东西是不错，就是太贵了。

## 黑名单
面对B面馆的值喝茶不吃面的人，B面馆负责人一怒之下将他们拍照入档，并禁止他们踏入店铺，但是有的时候遇到长得像的人也会禁止他进入店。这个就是设置黑名单，此方法秉承的就是“错杀一千，也不放一百”的原则，会封锁正常流量，影响到正常业务。

## DDoS 清洗
DDos 清洗，就是我发现客人进店几分钟以后，但是一直喝茶不要面的，我就把他踢出店里。
DDoS 清洗会对用户请求数据进行实时监控，及时发现DOS攻击等异常流量，在不影响正常业务开展的情况下清洗掉这些异常流量。

## CDN 加速
CDN 加速，我们可以这么理解：为了减少流氓骚扰，我干脆将面馆开到了线上，承接外卖服务，这样流氓找不到店在哪里，也耍不来流氓了。

在现实中，CDN 服务将网站访问流量分配到了各个节点中，这样一方面隐藏网站的真实 IP，另一方面即使遭遇 DDoS 攻击，也可以将流量分散到各个节点中，防止源站崩溃。


# DDoS黑色产业链中，各个角色是如何分工


DDoS攻击通过大量合法的请求占用大量网络资源，以达到使网络瘫痪的目的。具体攻击方式可分为以下几种：
1. 通过使网络过载来干扰甚至阻断正常的网络通讯；
2. 通过向服务器提交大量请求，使服务器超负荷；
3. 阻断某一用户访问服务器；
4. 阻断某服务与特定系统或个人的通讯。
DDoS攻击犯罪已经进入产业化时代——从需要专业不法黑客实施全部攻击过程的行为，发展成由发单人、攻击实施人、肉鸡商、出量人、不法黑客攻击软件作者、担保人等多个犯罪个体共同参与实施的产业化犯罪行为。


+ 发单人：是在DDoS攻击黑色产业链中顶端的角色，也就是出资并发出对具体网站或服务器的攻击需求的人。
+ 攻击实施人：是接到“发单人”指令并执行攻击的人。
+ 肉鸡商：是侵入计算机信息系统的实施人，或者买卖被侵入计算机系统权限的中间商。
+ 出量人：是拥有服务器控制权限和网络流量的人。他们有一定技术能力，能够租用专属服务器并自行配置攻击软件从而获取流量。
+ 担保人：是业内“信誉”较高的不法黑客。因为交易的双方往往并不认识，于是他们会找到作为“担保人”，负责买卖双方的资金中转，担保人可从中抽取一定的好处费。

# 正则表达式引发的血案：ReDOS
当正则表达式写的不好时，就可能被恶意输入利用，消耗大量的资源，从而造成dos,这种攻击称为ReDOS.

这种攻击是由于代码上的缺陷导致了，正则表达式是基于NFA的，他是一个状态机，很可能由于算法问题，导致资源消耗。

# 总结
DDOS攻击结算攻击者指导了服务器的真实ip,如果能隐藏真实ip,也是一个不错的选择。
