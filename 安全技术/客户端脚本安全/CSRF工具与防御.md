# 简介
跨站点伪造请求，Cross-Site Request Forgery（CSRF）
攻击可以在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击站点，从而在未授权的情况下执行在权限保护之下的操作，具有很大的危害性。

# 简单过程
例如在同一个浏览器中，在访问a.com后登陆了账户和密码。攻击者就可以可以构造一个吧b.com,在b.com里面加入`<img>`等标签，访问a.com的资源。那样操作a.com的功能。

# P3P的副作用
IE为了解决这个问题，加P3P头，但是有副作用，这里都不详解了。


# CSRF防御
## 验证码
CSRF攻击往往在用户不知情的情况下构造网络请求，验证码强制要求用户进行交互才能完成请求，因此能遏制CSRF攻击；但用户体验较差。
## Referer Check
在HTTP头中有一个字段叫Referer，它记录了该HTTP请求的来源地址。通过检查Referer是否合法来判断用户是否被CSRF攻击；但服务器并非什么时候都能取到Referer。
## Token
CSRF本质是所有参数都是被攻击者可以猜测的。出于这个原因把参数加密，或使用随机数，从而让攻击者无法猜测到参数值，这也是“不可预测性原则”的一个应用；但当网站同时存在XSS漏洞时，XSS可以模拟客户端读取token值，再构造合法请求，这过程又被称为XSRF。

使用Token 要注意token的保密性和随机性。


# 总结
CSRF 攻击是攻击者利用用户身份操作用户账户的一种攻击方式，设计CSRF的防御必须理解CSRF攻击的原理和本质。